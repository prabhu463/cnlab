# Create a new simulator instance
set ns [new Simulator]
# Open trace and NAM trace files
set tf [open lab3.tr w]
$ns trace-all $tf
set nf [open lab3.nam w]
$ns namtrace-all $nf
# Create nodes and set their properties
set n0 [$ns node]
$n0 color &quot;magenta&quot;
$n0 label &quot;src1&quot;
set n1 [$ns node]
set n2 [$ns node]
$n2 color &quot;magenta&quot;
$n2 label &quot;src2&quot;

set n3 [$ns node]
$n3 color &quot;blue&quot;
$n3 label &quot;dest2&quot;
set n4 [$ns node]
set n5 [$ns node]
$n5 color &quot;blue&quot;
$n5 label &quot;dest1&quot;
# Create LAN and duplex links
$ns make-lan &quot;$n0 $n1 $n2 $n3 $n4&quot; 100Mb 100ms LL Queue/DropTail
Mac/802_3
$ns duplex-link $n4 $n5 1Mb 1ms DropTail
# Create TCP agents and FTP applications
set tcp0 [new Agent/TCP]
$ns attach-agent $n0 $tcp0
set sink5 [new Agent/TCPSink]
$ns attach-agent $n5 $sink5
$ns connect $tcp0 $sink5
set ftp0 [new Application/FTP]
$ftp0 attach-agent $tcp0
$ftp0 set packetSize_ 500
$ftp0 set interval_ 0.0001
set tcp2 [new Agent/TCP]
$ns attach-agent $n2 $tcp2
set sink3 [new Agent/TCPSink]
$ns attach-agent $n3 $sink3
$ns connect $tcp2 $sink3

set ftp2 [new Application/FTP]
$ftp2 attach-agent $tcp2
$ftp2 set packetSize_ 600
$ftp2 set interval_ 0.001
# Create output files for tracing TCP windows
set file1 [open file1.tr w]
$tcp0 attach $file1
set file2 [open file2.tr w]
$tcp2 attach $file2
# Enable congestion window tracing
$tcp0 trace cwnd_
$tcp2 trace cwnd_
# Define the finish procedure
proc finish { } {
global ns nf tf
$ns flush-trace
close $tf
close $nf
exec nam lab3.nam &amp;
exit 0
}
# Schedule events
$ns at 0.1 &quot;$ftp0 start&quot;
$ns at 5 &quot;$ftp0 stop&quot;
$ns at 7 &quot;$ftp0 start&quot;
$ns at 0.2 &quot;$ftp2 start&quot;
$ns at 8 &quot;$ftp2 stop&quot;
$ns at 14 &quot;$ftp0 stop&quot;
$ns at 10 &quot;$ftp2 start&quot;

$ns at 15 &quot;$ftp2 stop&quot;
$ns at 16 &quot;finish&quot;
# Run the simulation
$ns run
